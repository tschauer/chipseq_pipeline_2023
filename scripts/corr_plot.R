


##################################################################################################################################
##################################################################################################################################



library(pheatmap)
library(RColorBrewer)

args = commandArgs(trailingOnly=TRUE)


##################################################################################################################################
##################################################################################################################################


input <- grep(".tab", args, value = TRUE)

output <- grep(".pdf", args, value = TRUE)


##################################################################################################################################
##################################################################################################################################


m <- read.table(input)

colnames(m) <- gsub(".coverage", "", colnames(m))
rownames(m) <- gsub(".coverage", "", rownames(m))


##################################################################################################################################
##################################################################################################################################


pdf(file = output, width = 6, height = 6)

pheatmap(m, 
         display_numbers = TRUE,
         main = "Spearman Correlation of Read Counts", 
         cellwidth = 50, cellheight = 50,
         color = colorRampPalette(rev(brewer.pal(9, name = "RdBu")))(101),
         breaks = seq(0,1, length.out = 101))

dev.off()


##################################################################################################################################
##################################################################################################################################










##################################################################################################################################
##################################################################################################################################
